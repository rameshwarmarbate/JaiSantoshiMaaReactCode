import{r as o,a as r}from"./react-bfabd40c.js";import{a as te,u as K}from"./react-redux-45d870ba.js";import{s as se,c as ae,e as ie,h as ne,L as le,i as me}from"./index-5f564d13.js";import{b as oe,a as ce}from"./react-router-1b5f20a2.js";import{O as de,Q as ue,a as pe,i as p,A as F,h as g,V as h,l as M}from"./material-e0a59a28.js";import"./@babel-e11bafe1.js";import"./react-dom-b0178e93.js";import"./scheduler-765c72db.js";import"./hoist-non-react-statics-6cfbf744.js";import"./use-sync-external-store-18921cc2.js";import"./redux-persist-d9cc1560.js";import"./redux-b7ba668d.js";import"./@reduxjs-4d37e7cf.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./axios-4a70c6fc.js";import"./react-router-dom-4405dfe9.js";import"./@remix-run-d753ad9e.js";import"./icons-material-4539f19e.js";import"./react-icons-55b3b9a0.js";import"./system-a1d29c52.js";import"./styled-engine-f3bd09bf.js";import"./@emotion-77835cc8.js";import"./stylis-79144faa.js";import"./utils-c03c978f.js";import"./private-theming-970ac73c.js";import"./react-transition-group-7ded6f4d.js";import"./dom-helpers-9a525042.js";import"./base-ff50cfe3.js";import"./@popperjs-f3391c26.js";const X={branch:"",type:"",employee:"",username:"",password:"",confirmPassword:""},U={branch:{invalid:!1,message:""},type:{invalid:!1,message:""},employee:{invalid:!1,message:""},username:{invalid:!1,message:""},password:{invalid:!1,message:""},confirmPassword:{invalid:!1,message:""}},je=()=>{const v=te(),y=K(e=>e.user),W=oe(),{userId:L}=W.state?W.state:{userId:""},Y=K(se),[c,Z]=o.useState([]),[a,u]=o.useState({}),[s,A]=o.useState(U),[O,m]=o.useState(""),[d,$]=o.useState([]),q=ce();o.useEffect(()=>{var e,t;if(a.branch||a.employee){const i=(e=c==null?void 0:c.find)==null?void 0:e.call(c,l=>l._id===a.branch),n=(t=d==null?void 0:d.find)==null?void 0:t.call(d,({_id:l})=>l===a.employee);i!=null&&i._id&&u(l=>({...l,branch:i,employee:n}))}},[c,a,d]),o.useEffect(()=>{v(ae()).then(({payload:e={}})=>{const{message:t}=(e==null?void 0:e.data)||{};t?m(t):Z(e==null?void 0:e.data)}).catch(e=>{m(e.message)}),v(ie()).then(({payload:e={}})=>{const{message:t}=(e==null?void 0:e.data)||{};t?m(t):$(e==null?void 0:e.data)}).catch(e=>{m(e.message)})},[]),o.useEffect(()=>{L&&v(ne(L)).then(({payload:e={}})=>{u({...(e==null?void 0:e.data)||{},password:"",confirmPassword:""})}).catch(()=>{m("Something went wrong! Please try later or contact Administrator.")})},[L]);const N=e=>{const t=e.target.name,i=e.target.value;u(n=>({...n,[t]:i}))},z=(e,t)=>{u(i=>({...i,[t]:e}))},D=e=>{var n,l,f,I,E,_,k,w,T,b,R,P,Q,C,V,j,S,G,x,J;const t={...U};H()||(e.branch||(t.branch={invalid:!0,message:"Branch is required"}),e.type||(t.type={invalid:!0,message:"User type is required"}),e.employee||(t.employee={invalid:!0,message:"Employee is required"})),(!e.username||!((l=(n=e.username)==null?void 0:n.trim)!=null&&l.call(n)))&&(t.username={invalid:!0,message:"Username is required"}),!e.password||!((I=(f=e.password)==null?void 0:f.trim)!=null&&I.call(f))?t.password={invalid:!0,message:"Password is required"}:((k=(_=(E=e.password)==null?void 0:E.trim)==null?void 0:_.call(E))==null?void 0:k.length)<5?t.password={invalid:!0,message:"Password length should be 5 or more characters"}:((T=(w=e.password)==null?void 0:w.trim)==null?void 0:T.call(w))!==((R=(b=e.confirmPassword)==null?void 0:b.trim)==null?void 0:R.call(b))&&(t.password={invalid:!0,message:"Password and Confirm password does not match"}),!e.confirmPassword||!((Q=(P=e.confirmPassword)==null?void 0:P.trim)!=null&&Q.call(P))?t.confirmPassword={invalid:!0,message:"Confirm password is required"}:((j=(V=(C=e.password)==null?void 0:C.trim)==null?void 0:V.call(C))==null?void 0:j.length)<5?t.confirmPassword={invalid:!0,message:"Confirm password length should be 5 or more characters"}:((G=(S=e.password)==null?void 0:S.trim)==null?void 0:G.call(S))!==((J=(x=e.confirmPassword)==null?void 0:x.trim)==null?void 0:J.call(x))&&(t.confirmPassword={invalid:!0,message:"Password and Confirm password does not match"});let i=!1;for(const re in t)t[re].invalid===!0&&(i=!0);return i&&A(t),i},ee=e=>{var t,i;e.preventDefault(),D(a)||v(me({...a,place:(t=a.branch)==null?void 0:t._id,employee:(i=a.employee)==null?void 0:i._id})).then(({payload:n={}})=>{const{message:l}=(n==null?void 0:n.data)||{};l?m(l):(m(""),u(X),B())}).catch(()=>{m("Something went wrong! Please try later or contact Administrator.")})},B=o.useCallback(()=>{u(X),A(U),m(""),q("/users/usersList")},[q]),H=()=>{var e,t;return y&&y.type&&((t=(e=y.type)==null?void 0:e.toLowerCase)==null?void 0:t.call(e))==="superadmin"};return r.createElement(r.Fragment,null,Y&&r.createElement(le,null),r.createElement("h1",{className:"pageHead"},"Edit a user"),r.createElement("div",{className:"inner-wrap"},O!==""&&r.createElement(de,{sx:{width:"100%",margin:"0 0 30px 0",border:"1px solid red",borderRadius:"4px"},spacing:2},r.createElement(ue,{severity:"error"},O)),a&&a._id&&r.createElement("form",{action:"",onSubmit:ee},r.createElement(pe,{sx:{padding:"20px",marginBottom:"20px"}},r.createElement("div",{className:"grid grid-6-col"},H()?null:r.createElement(r.Fragment,null,r.createElement("div",{className:"grid-item"},r.createElement(p,{fullWidth:!0,error:s.branch.invalid,size:"small"},r.createElement(F,{disablePortal:!0,size:"small",name:"branch",options:c,value:a.branch||null,onChange:(e,t)=>z(t,"branch"),getOptionLabel:e=>e.name||"",openOnFocus:!0,renderInput:e=>r.createElement(g,{...e,label:"Branch",error:s.branch.invalid,fullWidth:!0})}),s.branch.invalid&&r.createElement(h,null,s.branch.message))),r.createElement("div",{className:"grid-item"},r.createElement(p,{fullWidth:!0,error:s.type.invalid,size:"small"},r.createElement(F,{disablePortal:!0,size:"small",name:"type",options:["Admin","User"],value:a.type||null,onChange:(e,t)=>z(t,"type"),getOptionLabel:e=>e||"",openOnFocus:!0,renderInput:e=>r.createElement(g,{...e,label:"User Type",error:s.type.invalid,fullWidth:!0})}),s.type.invalid&&r.createElement(h,null,s.type.message))),r.createElement("div",{className:"grid-item"},r.createElement(p,{fullWidth:!0,error:s.employee.invalid,size:"small"},r.createElement(F,{disablePortal:!0,size:"small",name:"employee",options:d,value:a.employee||null,onChange:(e,t)=>z(t,"employee"),getOptionLabel:e=>e.name||"",openOnFocus:!0,renderInput:e=>r.createElement(g,{...e,label:"Employee",error:s.employee.invalid,fullWidth:!0})}),s.employee.invalid&&r.createElement(h,null,s.employee.message)))),r.createElement("div",{className:"grid-item"},r.createElement(p,{fullWidth:!0,error:s.username.invalid},r.createElement(g,{variant:"outlined",size:"small",label:"Username",error:s.username.invalid,value:a.username,onChange:N,name:"username",id:"username",disabled:!0,inputProps:{maxLength:50}}),s.username.invalid&&r.createElement(h,null,s.username.message))),r.createElement("div",{className:"grid-item"},r.createElement(p,{fullWidth:!0,error:s.password.invalid},r.createElement(g,{variant:"outlined",size:"small",label:"Password",error:s.password.invalid,type:"password",value:a.password,onChange:N,name:"password",id:"password",inputProps:{maxLength:20}}),s.password.invalid&&r.createElement(h,null,s.password.message))),r.createElement("div",{className:"grid-item"},r.createElement(p,{fullWidth:!0,error:s.confirmPassword.invalid},r.createElement(g,{variant:"outlined",size:"small",label:"Confirm Password",error:s.confirmPassword.invalid,type:"password",value:a.confirmPassword,onChange:N,name:"confirmPassword",id:"confirmPassword",inputProps:{maxLength:20}}),s.confirmPassword.invalid&&r.createElement(h,null,s.confirmPassword.message)))),r.createElement("div",{className:"right"},r.createElement(M,{variant:"outlined",size:"medium",onClick:B},"Cancel"),r.createElement(M,{variant:"contained",size:"medium",type:"submit",color:"primary",className:"ml6"},"Save"))))))};export{je as default};
